# tg-nutritionology-bot

Telegram-бот на Node.js (Telegraf), который:
- показывает статичный текст по команде `/price`;
- показывает список бесплатных гайдов по команде `/guides` с кнопками;
- поддерживает deep-link: `t.me/<ВАШ_БОТ>?start=<slug>` сразу открывает нужный гайд;
- перед отправкой файла проверяет, подписан ли пользователь на канал.

## Быстрый старт

1) Установите зависимости:
```
npm install
```

2) Создайте файл `.env` в корне проекта со значениями:
```
BOT_TOKEN=123456:ABCDEF_your_bot_token_here
# Используйте @username для публичного канала или -100XXXXXXXXXX для ID
CHANNEL_ID=@your_channel_username
PRICE_TEXT=Актуальная стоимость: 990₽
```

3) Добавьте PDF/файлы гайдов в `storage/guides/`. Пример имен из `src/guides.json`:
- `storage/guides/protein-cheatsheet.pdf`
- `storage/guides/hydration-guide.pdf`

4) Отредактируйте список гайдов в `src/guides.json`:
```json
[
  {
    "slug": "protein-cheatsheet",
    "title": "Шпаргалка по белкам",
    "description": "Краткий гид по суточным нормам и источникам белка.",
    "file": "protein-cheatsheet.pdf"
  }
]
```

5) Запустите бота:
```
npm start
```

## Команды
- `/start` — приветствие. Если есть payload (slug), бот сразу покажет карточку нужного гайда.
- `/price` — показать статичный текст стоимости.
- `/guides` — вывести список бесплатных гайдов с кнопками.

## Deep-link
Формат: `t.me/<ВАШ_БОТ>?start=<slug>`  
Например: `t.me/your_bot?start=protein-cheatsheet`

## Проверка подписки
Перед отправкой файла бот проверяет статус участника в канале `CHANNEL_ID` через `getChatMember`.  
Допустимые статусы: `member`, `administrator`, `creator`. Если пользователь не подписан — бот предложит подписаться и повторить попытку.

Важно:
- Боту нужны права на просмотр участников канала (добавьте бота в канал).
- Для приватных каналов используйте ID формата `-100...` и убедитесь, что бот имеет доступ.

## Стек
- Node.js + Telegraf
- Конфигурация через `.env`